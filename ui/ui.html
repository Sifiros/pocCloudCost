<script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/moment.js/2.19.1/moment.min.js"></script>
<script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/moment.js/2.19.1/locale/fr.js"></script>
<script
  src="https://code.jquery.com/jquery-3.2.1.min.js"
  integrity="sha256-hwg4gsxgFZhOsEEamdOYGBf13FyQuiTwlAQgxVSNgt4="
  crossorigin="anonymous"></script>
<script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/Chart.js/2.7.1/Chart.min.js"></script>
<script type="text/javascript" src="./savingChart.js"></script>
<script type="text/javascript" src="./horizontalLineChartPlugin.js"></script>
<script type="text/javascript" src="./eventSavings.json"></script>
<style>
    canvas {
        -moz-user-select: none;
        -webkit-user-select: none;
        -ms-user-select: none;
    }
</style>
<h1>Test</h1>
<div style="width:75%;">
    <canvas id="teevityChart"></canvas>
</div>

<script>

    window.onload = function() {
        registerPlugin('teevityChart');
        var datasets = Object.keys(datas.events).map(function(eventName) {
            return metricsToDataset(eventName, datas.events[eventName])
        })
        datasets.push(metricsToDataset('Total costs', datas.costs))
        window.chart = new TeevityChart('teevityChart', 'Teevity Savings', datasets)
        // window.addMockDataset();
        window.chart.refresh();

        function metricsToDataset(datasetName, resources) {
                return ({
                    label: datasetName,
                    data: resources.map(function(cur) {
                        cur.value = (typeof cur.saving != 'undefined' ? cur.saving : -cur.costs);
                        return cur;
                    }),
                    fill: true
                });
        }

    }
</script>